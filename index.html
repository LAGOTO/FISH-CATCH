<!doctype html>
<html lang="bg">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Inline favicon to avoid 404 -->
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%230c2747'/%3E%3Cpath d='M6 16c4-4 10-4 14 0-4 4-10 4-14 0z' fill='%237bd389'/%3E%3Ccircle cx='20' cy='14' r='1.8' fill='white'/%3E%3C/svg%3E" />
  <title>–ò–≥—Ä–∞–π ‚Äì –ö—ä—Å–º–µ—Ç –∑–∞ —É–ª–æ–≤–∞</title>
  <style>
    :root{ --sea1:#0c2747; --sea2:#144a7a; --sky2:#cfeaff; --ui:#ffffff; --accent:#7bd389; --muted:#cfe2f5; --glass:rgba(255,255,255,.12); --glass-b:rgba(255,255,255,.18); }
    html,body{height:100%;margin:0}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif;background:linear-gradient(#071426,#0a1b2a);color:var(--ui);display:flex;align-items:center;justify-content:center}

    .game{
      width:min(1100px,96vw); height:min(816px,78vh);
      position:relative; border-radius:20px; overflow:hidden;
      box-shadow:0 18px 50px rgba(0,0,0,.55);
      background:radial-gradient(1200px 600px at 50% -40%, var(--sky2), var(--sea1) 60%);
    }
    header{position:absolute; left:12px; right:12px; top:12px; display:flex; justify-content:space-between; align-items:center; z-index:8}
    .brand{font-weight:800; letter-spacing:.4px}
    .pill{backdrop-filter: blur(6px); background:var(--glass); border:1px solid var(--glass-b); padding:6px 10px; border-radius:999px; font-weight:700}

    .lake{position:absolute; inset:0;}
    .water{position:absolute; left:0; right:0; top:20%; bottom:0; background:linear-gradient(180deg, var(--sea2), var(--sea1));}
    .shore{position:absolute; left:0; right:0; bottom:0; height:14%; background:linear-gradient(180deg,#3c2b1a,#24190f);}
    .ripples{position:absolute; inset:0; pointer-events:none; z-index:20}

    .grid{
      position:absolute; left:6%; right:6%; top:18%; bottom:18%;
      display:grid; grid-template-columns:repeat(3,1fr); grid-template-rows:repeat(3,1fr);
      gap:12px; z-index:6;
    }
    .grid.locked{ pointer-events:none; opacity:0.9; }

    .cell{
      position:relative; border-radius:12px;
      outline:2px dashed rgba(255,255,255,.55);
      background:rgba(255,255,255,.08);
      cursor:pointer; transition:transform .08s ease, background .15s ease;
      display:flex; align-items:center; justify-content:center;
    }
    .cell:hover{transform:translateY(-2px); background:rgba(255,255,255,.16)}
    .cell span{position:absolute; left:8px; top:6px; font-size:12px; color:var(--muted)}
    .cell b{font-size:22px; color:#fff; opacity:.9}

    .overlay{position:absolute; inset:0; display:grid; place-items:center; z-index:50}
    .card{background:rgba(0,0,0,.35); border:1px solid rgba(255,255,255,.18); border-radius:16px; padding:22px}
    button{cursor:pointer; border:0; border-radius:12px; padding:10px 14px; font-weight:800}
    .btn{background:var(--accent)}

    .splash{position:absolute; width:8px; height:8px; border-radius:50%; background:#fff; opacity:.9; pointer-events:none; transform:translate(-50%,-50%); animation:splash 1.2s ease-out forwards}
    @keyframes splash{0%{box-shadow:0 0 0 0 rgba(255,255,255,.6)}100%{box-shadow:0 0 0 30px rgba(255,255,255,0); opacity:0}}
    .spinner{position:absolute; transform:translate(-50%,-50%); width:28px; height:28px; border-radius:50%; border:3px solid rgba(255,255,255,.35); border-top-color:#fff; animation:spin .8s linear infinite; z-index:14; pointer-events:none}
    @keyframes spin{to{transform:translate(-50%,-50%) rotate(360deg)}}

    .bubble{
      position:absolute; pointer-events:auto;
      left:50%; top:90%;
      transform:translate(-50%,-100%) scale(.92); transform-origin:50% 100%;
      background:rgba(0,0,0,.35); border:1px solid var(--glass-b); border-radius:14px;
      padding:10px 12px; min-width:220px; z-index:15; opacity:0; animation:pop .18s ease-out forwards;
    }
    .bubble::after{content:""; position:absolute; left:50%; bottom:-10px; transform:translateX(-50%); border:10px solid transparent; border-top-color:rgba(0,0,0,.35)}
    .b-row{display:grid; grid-template-columns:auto 1fr; gap:6px 10px; font-size:14px}
    .b-title{margin:0 0 6px; font-weight:800}
    .b-actions{display:flex; gap:8px; margin-top:8px}
    @keyframes pop{from{opacity:0; transform:translate(-50%,-100%) scale(.92)} to{opacity:1; transform:translate(-50%,-100%) scale(1)}}
  </style>
</head>
<body>
  <div class="game" id="game">
    <header>
      <div class="brand">LAGO ‚Äì HASWING</div>
      <div class="pill">–•–≤—ä—Ä–ª—è–π!</div>
    </header>

    <div class="lake">
      <div class="water"></div>
      <div class="grid" id="grid"></div>
      <div class="ripples" id="ripples"></div>
      <div class="shore"></div>
    </div>

    <!-- –°—Ç–∞—Ä—Ç -->
    <div class="overlay" id="start">
      <div class="card">
        <button class="btn" id="play" onclick="window.startGame && window.startGame()">–°—Ç–∞—Ä—Ç</button>
      </div>
    </div>
  </div>

<script>
(() => {
  'use strict';
  if (document.readyState === 'loading') { document.addEventListener('DOMContentLoaded', init); } else { init(); }

  function init(){
    const grid=document.getElementById('grid'), ripples=document.getElementById('ripples'), startUI=document.getElementById('start'), playBtn=document.getElementById('play');

    let actx; const ctx=()=>actx||(actx=new (window.AudioContext||window.webkitAudioContext)());
    function ensureAudio(){try{const a=ctx(); if(a.state==='suspended') a.resume();}catch(e){}}
    function popSound(){ ensureAudio(); const a=ctx(), o=a.createOscillator(), g=a.createGain(); o.type='triangle'; o.frequency.value=420; g.gain.value=0.18; o.connect(g); g.connect(a.destination); const t=a.currentTime; o.start(t); o.stop(t+0.12); g.gain.setValueAtTime(0.18,t); g.gain.exponentialRampToValueAtTime(0.001,t+0.12); }

    function startGame(){ if(startUI&&startUI.parentNode) startUI.parentNode.removeChild(startUI); build(); }
    window.startGame=startGame;
    if(playBtn) playBtn.addEventListener('click', startGame);

    const rows=3, cols=3; let locked=false;
    function build(){ grid.innerHTML=''; let idx=1; for(let r=0;r<rows;r++){ for(let c=0;c<cols;c++){ const cell=document.createElement('div'); cell.className='cell'; const lab=document.createElement('span'); const dist=r===2?'–±–ª–∏–∑–æ':r===1?'—Å—Ä–µ–¥–Ω–æ':'–¥–∞–ª–µ—á'; const col=c===0?'–ª—è–≤–æ':c===1?'—Ü–µ–Ω—Ç—ä—Ä':'–¥—è—Å–Ω–æ'; lab.textContent=`${dist} ‚Ä¢ ${col}`; cell.appendChild(lab); const num=document.createElement('b'); num.textContent=idx++; cell.appendChild(num); cell.addEventListener('click',()=>cast(r,c,cell)); grid.appendChild(cell);} } }

    const species=[{id:'perch',name:'–ö–æ—Å—Ç—É—Ä',emoji:'üêü',w:[0.1,1.2],depth:[1,4],wait:[5,40]},{id:'pike',name:'–©—É–∫–∞',emoji:'ü¶à',w:[0.8,8],depth:[0.5,2.5],wait:[10,60]},{id:'zander',name:'–ë—è–ª–∞ —Ä–∏–±–∞',emoji:'üê†',w:[0.7,4.5],depth:[2,8],wait:[15,120]},{id:'catfish',name:'–°–æ–º',emoji:'üê°',w:[2,30],depth:[3,10],wait:[30,180]}];
    const distRowWeights=[[0.25,0.2,0.45,0.1],[0.4,0.3,0.25,0.05],[0.55,0.3,0.12,0.03]];
    const rnd=(a,b)=>Math.random()*(b-a)+a, clamp=(v,a,b)=>Math.max(a,Math.min(b,v)), fmtWait=(s)=>s<60?`${s} —Å–µ–∫`:`${Math.floor(s/60)} –º–∏–Ω ${s%60? s%60+' —Å–µ–∫':''}`, pickWeighted=(arr)=>{const x=Math.random();let acc=0;for(let i=0;i<arr.length;i++){acc+=arr[i];if(x<=acc)return i;}return arr.length-1;};

    function splash(x,y){const s=document.createElement('div');s.className='splash';s.style.left=`${x+grid.offsetLeft}px`;s.style.top=`${y+grid.offsetTop}px`;ripples.appendChild(s);setTimeout(()=>s.remove(),1200);}
    function spinnerAt(x,y){const sp=document.createElement('div');sp.className='spinner';sp.style.left=`${x+grid.offsetLeft}px`;sp.style.top=`${y+grid.offsetTop}px`;ripples.appendChild(sp);return sp;}
    function bubbleAt(x,y,f,w,d,t){
      const bub=document.createElement('div');bub.className='bubble';
      bub.innerHTML=`<div class=\"b-title\">${f.emoji} ${f.name}</div><div class=\"b-row\"><div>–¢–µ–≥–ª–æ:</div><div>${w.toFixed(w<1?2:1)} –∫–≥</div><div>–î—ä–ª–±–æ—á–∏–Ω–∞:</div><div>${d.toFixed(1)} –º</div><div>–ß–∞–∫–∞–Ω–µ:</div><div>${fmtWait(t)}</div></div><div class=\"b-actions\"><button class=\"btn\" id=\"againBtn\">–ò–≥—Ä–∞–π –ø–∞–∫</button></div>`;
      ripples.appendChild(bub);
      requestAnimationFrame(()=>{bub.style.opacity='1';});
      bub.querySelector('#againBtn').addEventListener('click',()=>{bub.remove();locked=false;grid.classList.remove('locked');});
    }

    function cast(r,c,cell){ if(locked)return; locked=true; grid.classList.add('locked'); const rect=cell.getBoundingClientRect(), grect=grid.getBoundingClientRect(), x=rect.left+rect.width/2-grect.left, y=rect.top+rect.height/2-grect.top; splash(x,y); const f=species[pickWeighted(distRowWeights[r])]; const depthAdj=r===2?-0.6:r===1?0:0.6; const w=rnd(f.w[0],f.w[1]); const d=clamp(rnd(f.depth[0],f.depth[1])+depthAdj,0.4,12); const t=Math.round(rnd(f.wait[0],f.wait[1])); const spin=spinnerAt(x,y); setTimeout(()=>{spin.remove();popSound();bubbleAt(x,y,f,w,d,t);},650); }
  }
})();
</script>
</body>
</html>
